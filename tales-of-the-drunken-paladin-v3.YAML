game:
  title: Tales of the Drunken Paladin
  version: 3.0
  runner: wine

files:
  setup:
    url: http://www.drunkenpaladin.com/Tales%20of%20the%20Drunken%20Paladin%20V3.zip
  rtp:
    url: https://dl.komodo.jp/rpgmakerweb/run-time-packages/RPGVXAce_RTP.zip

wine:
  version: "System"
  system: true
  dxvk: true

installer:
  - extract:
      file: setup
      dst: $CACHE
  - move:
      src: $CACHE/TalesOfTheDrunkenPaladin
      dst: $GAMEDIR/drive_c/Tales of The Drunken Paladin
  - extract:
      file: rtp
      dst: $CACHE
  - execute:
      file: $CACHE/RPGVXAce_RTP/setup.exe
      args: /S
  - task:
      description: Installing additional Windows components
      name: winetricks
      prefix: $GAMEDIR
      verbs:
        - dmusic
        - dsound
        - gmsls

system:
  env:
    WINEARCH: win64
    WINEPREFIX: $GAMEDIR

  pre_install:
    - mkdir -p "$GAMEDIR/drive_c"

  post_install:
    - winecfg
    - wine reg add 'HKCU\Software\Wine\X11 Driver' /v 'UseTakeFocus' /t REG_SZ /d 'N' /f

scripts:
  run:
    - wine "$GAMEDIR/drive_c/Tales of The Drunken Paladin/game.exe"
